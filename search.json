[{"title":"彩票","url":"/2022/03/22/彩票/","content":"\n\n\n\n\n使用聚合数据的接口，获取彩票历史数据，随机生成彩票，或者根据历史数据出现的频率生成数据。\n\n```python\n# 获取近期的数据\nimport requests\n\nfor i in ['ssq', 'dlt']:\n    url = f'http://apis.juhe.cn/lottery/history?lottery_id={i}&page_size=50&page=1&key=59cab4131e0d9d15c8dde4e75e4fd05f'\n    r = requests.post(url=url)\n    with open(f'./temp/{i}.json', 'w') as f:\n        f.write(str(r.json()))\n\n```\n\n\n\n```python\n# 对获取的数据进行格式化显示\nwith open('./temp/ssq.json', 'r') as f:\n    content = eval(f.read())\n\ncontentL = content.get('result').get('lotteryResList')\n\nwith open('./temp/ssq_new.json', 'w') as f:\n    for i in contentL:\n        f.write(i.get('lottery_date'))\n        f.write(' ')\n        f.write(i.get('lottery_res'))\n        f.write('\\n')\n\n\nwith open('./temp/dlt.json', 'r') as f:\n    content = eval(f.read())\n\ncontentL = content.get('result').get('lotteryResList')\n\nwith open('./temp/dlt_new.json', 'w') as f:\n    for i in contentL:\n        f.write(i.get('lottery_date'))\n        f.write(' ')\n        f.write(i.get('lottery_res'))\n        f.write('\\n')\n\n```\n\n\n\n```python\n# 大乐透\nimport random, time\n\n\ndef func1(n):\n    l1, l2 = ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16',\n              '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31', '32',\n              '33', '34', '35'], ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12']\n    for o in range(n):\n        time.sleep(random.random())\n\n        l11 = random.sample(l1, 5)\n        l11.sort()\n        l22 = random.sample(l2, 2)\n        l22.sort()\n\n        for a in l11:\n            l1.remove(a)\n        for b in l22:\n            l2.remove(b)\n\n        for i, j in enumerate(l11):\n            if i == 4:\n                print(j, end=' + ')\n            elif i == 5:\n                print(j)\n            else:\n                print(j, end='、')\n        for m, k in enumerate(l22):\n            if m == 0:\n                print(k, end='、')\n            else:\n                print(k)\n\n\ndef func2():\n    time.sleep(random.random())\n    d1 = {'01': 0, '02': 0, '03': 0, '04': 0, '05': 0, '06': 0, '07': 0, '08': 0, '09': 0, '10': 0, '11': 0, '12': 0,\n          '13': 0, '14': 0, '15': 0, '16': 0, '17': 0, '18': 0, '19': 0, '20': 0, '21': 0, '22': 0, '23': 0, '24': 0,\n          '25': 0, '26': 0, '27': 0, '28': 0, '29': 0, '30': 0, '31': 0, '32': 0, '33': 0, '34': 0, '35': 0}\n    d2 = {'01': 0, '02': 0, '03': 0, '04': 0, '05': 0, '06': 0, '07': 0, '08': 0, '09': 0, '10': 0, '11': 0, '12': 0}\n    with open('./temp/dlt.json', 'r') as f:\n        content = eval(f.read())\n    # print(content)\n    l = content.get('result').get('lotteryResList')\n    for i in l:\n        l1 = i.get('lottery_res').split(',')\n        for m, n in enumerate(l1):\n            if m == 6:\n                d2[n] += 1\n            else:\n                d1[n] += 1\n    # print(d1, d2)\n    d11 = sorted(d1.items(), key=lambda x: x[1])\n    d22 = sorted(d2.items(), key=lambda x: x[1])\n    # print(d11, d22)\n\n    l11, l22 = [], []\n    for i in d11[0:19]:\n        l11.append(i[0])\n\n    for i in d22[0:7]:\n        l22.append(i[0])\n\n    l111 = random.sample(l11, 5)\n    l222 = random.sample(l22, 2)\n    l111.sort()\n    l222.sort()\n\n    for i, j in enumerate(l111):\n        if i == 4:\n            print(j, end=' + ')\n        elif i == 5:\n            print(j)\n        else:\n            print(j, end='、')\n    for m, k in enumerate(l222):\n        if m == 0:\n            print(k, end='、')\n        else:\n            print(k)\n\n\n# func2()\n# func2()\nfunc2()\nfunc1(1)\n```\n\n\n\n```python\n# 双色球\nimport random, time\n\n\ndef func1(n):\n    \"\"\"随机获取n组数据\"\"\"\n    l1, l2 = ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15', '16',\n              '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31', '32',\n              '33'], ['01', '02', '03', '04', '05', '06', '07', '08', '09', '10', '11', '12', '13', '14', '15',\n                      '16']\n    for k in range(n):\n        l = []\n        time.sleep(random.random())\n\n        l11 = random.sample(l1, 6)\n        l11.sort()\n        l22 = random.sample(l2, 1)\n        l = l11 + l22\n\n        for a in l11:\n            l1.remove(a)\n        for b in l22:\n            l2.remove(b)\n\n        # 格式化输出\n        for i, j in enumerate(l):\n            if i == 5:\n                print(j, end=' + ')\n            elif i == 6:\n                print(j)\n            else:\n                print(j, end='、')\n\n\ndef func2():\n    \"\"\"从数据源筛选出现次数高中低各一组\"\"\"\n    time.sleep(random.random())\n    d1 = {'01': 0, '02': 0, '03': 0, '04': 0, '05': 0, '06': 0, '07': 0, '08': 0, '09': 0, '10': 0, '11': 0, '12': 0,\n          '13': 0, '14': 0, '15': 0, '16': 0, '17': 0, '18': 0, '19': 0, '20': 0, '21': 0, '22': 0, '23': 0, '24': 0,\n          '25': 0, '26': 0, '27': 0, '28': 0, '29': 0, '30': 0, '31': 0, '32': 0, '33': 0}\n    d2 = {'01': 0, '02': 0, '03': 0, '04': 0, '05': 0, '06': 0, '07': 0, '08': 0, '09': 0, '10': 0, '11': 0, '12': 0,\n          '13': 0, '14': 0, '15': 0, '16': 0}\n    with open('./temp/ssq.json', 'r') as f:\n        content = eval(f.read())\n    l = content.get('result').get('lotteryResList')\n    for i in l:\n        l1 = i.get('lottery_res').split(',')\n        for m, n in enumerate(l1):\n            if m == 6:\n                d2[n] += 1\n            else:\n                d1[n] += 1\n\n    d11 = sorted(d1.items(), key=lambda x: x[1])\n    d22 = sorted(d2.items(), key=lambda x: x[1])\n    l11, l22 = [], []\n    # print(d11)\n    # print(d22)\n\n    # print(d11[0:16])\n    for i in d11[0:16]:\n        l11.append(i[0])\n    # print(l11)\n\n    # print(d22[0:8])\n    for i in d22[0:8]:\n        l22.append(i[0])\n    # print(l22)\n\n    l111 = random.sample(l11, 6)\n    l111.sort()\n    res = l111 + random.sample(l22, 1)\n\n    for i, j in enumerate(res):\n        if i == 5:\n            print(j, end=' + ')\n        elif i == 6:\n            print(j)\n        else:\n            print(j, end='、')\n\n\nfunc2()\nfunc2()\nfunc2()\nfunc1(2)\n```\n\n","tags":["Python"]},{"title":"愿每一只孔雀都能平安落地","url":"/2022/03/21/愿每一只孔雀都能平安落地/","content":"\n\n\n今天惊闻一则新闻，东方航空一客机在广西坠毁，132人遇难。\n\n听到后心情久久不能平静，真的是谁都不知明天和意外哪个先来。\n\n只希望岁月静好，每一只孔雀都能平安落地。\n\n珍惜现在的一切。\n\n","tags":["生活"]},{"title":"Python操作Excel库tablib","url":"/2022/03/19/Python操作Excel库tablib/","content":"\n\n\n```python\nimport tablib\n\nheaders = ('车牌', '设备', '状态')\ndata = [('苏E12345', 'ADAS', '在线')]\ndata = tablib.Dataset(*data, headers=headers)\n\nwith open('./dist/NewExcel.xls', 'wb') as f:\n    f.write(data.xls)\n```\n\n","tags":["Python"]},{"title":"Python脚本实现钉钉群通知","url":"/2022/03/18/Python脚本实现钉钉群通知/","content":"\n\n\n代码中的token需要在钉钉群中添加机器人后获得\n\n```python\nimport requests, json\n\n\ndef send_message(content):\n    url = 'https://oapi.dingtalk.com/robot/send?access_token=xxx'\n    pagrem = {\n        \"msgtype\": \"text\",\n        \"text\": {\n            \"content\": \"异常：%s \" % (content)\n        },\n        \"at\":{\n            \"atMobiles\":[\n                \"xxx\"       #需要填写自己的手机号，钉钉通过手机号@对应人\n            ],\n            \"isAtAll\": False        #是否@所有人，默认否\n        }\n    }\n    headers = {\n        'Content-Type': 'application/json'\n    }\n    requests.post(url, data=json.dumps(pagrem), headers=headers)\n\n\nif __name__ == \"__main__\":\n    send_message('异常测试')\n```\n\n","tags":["Python"]},{"title":"Python记录日志到文件logging的使用","url":"/2022/03/18/Python记录日志到文件logging的使用/","content":"\n```python\n# 设置日志\nlogging.basicConfig(level=logging.INFO, filename='./api_monitor_log.txt', filemode='a',format='%(asctime)s - %(levelname)s: %(message)s')\n\n# 记录日志\nlogging.error('记录错误日志的内容')\n```\n\n","tags":["Python"]},{"title":"微信小程序iOS关于时间格式的处理","url":"/2022/03/18/微信小程序iOS关于时间格式的处理/","content":"\n\n\n在苹果系统中不支持ISO-8601标准格式的时间字符串\n\niOS在使用new Date()创建日期的时候，无法识别yyyy-MM-dd格式的日期，只能识别yyyy/MM/dd形式的日期，而且对连接符 T 也不能正确识别\n\n所以会出现Android微信小程序显示日期正常，iOS微信小程序显示日期异常的问题。\n\n","tags":["工作"]},{"title":"Android/iOS应用频繁切换功能标签出现闪退的bug","url":"/2022/03/18/Android-iOS应用频繁切换功能标签出现闪退的bug/","content":"\n\n\n在移动应用上，如果A功能和B功能都需要请求接口获取数据，那么频繁切换A和B功能，当A功能未返回数据时候点击B接口，可能会产生应用闪退的情况。\n\n","tags":["工作"]},{"title":"关于定时任务统计数据的注意点","url":"/2022/03/17/关于定时任务统计数据的注意点/","content":"假如每小时统计一次数据，那么可以9点统计8-9点的数据情况。\n\n但是9点这一时刻要保证8-9点的数据都已经上报、因为数据上报存在延迟、补传等。\n\n所以最好能够确定设备延迟和补传的最大时间阈值、假设最大延迟和补传的时间是30分钟，那么定时任务可以设置成9:30统计8-9点的数据。\n\n","tags":["工作"]}]